<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <title>Notas Formulários</title>
</head>

<body>
  <h2>Atualizar notas</h2>

  <label>ID do Formulário 1:
    <input type="text" id="form1" placeholder="ID do Formulário 1" required>
  </label><br><br>

  <label>ID do Formulário 2:
    <input type="text" id="form2" placeholder="ID do Formulário 2" required>
  </label><br><br>

  <label>Mês:
    <input type="text" id="mes" placeholder="Agosto" required>
  </label><br><br>

  <label>Ano:
    <input type="text" id="ano" placeholder="2025" required>
  </label><br><br>

  <h3>Planilha CS</h3>
  <label>ID da planilha CS:
    <input type="text" id="sheetIdCS" placeholder="ID da planilha CS" required>
  </label><br><br>

  <label>GID da aba CS:
    <input type="text" id="gidCS" placeholder="0" value="0" required>
  </label><br><br>

  <h3>Planilha Service</h3>
  <label>ID da planilha Service:
    <input type="text" id="sheetIdService" placeholder="ID da planilha Service" required>
  </label><br><br>

  <label>GID da aba Service:
    <input type="text" id="gidService" placeholder="0" value="0" required>
  </label><br><br>

  <label>Data (para Service):
    <input type="text" id="dataService" placeholder="20/08/2025" required>
  </label><br><br>

  <button onclick="atualizarNotas()">Atualizar</button>

  <pre id="resultado"></pre>

  <script>
    const GAS_URL = "https://script.google.com/macros/s/AKfycbyu7DPbrj0leRxVCA5_FtOKyVdveIQPtKTu1_d1ZbIScyQkI2Akw8TTMiWxgpot5D4U/exec"; // <<< substitua aqui depois de publicar

    async function atualizarNotas() {
      const form1 = document.getElementById("form1").value.trim();
      const form2 = document.getElementById("form2").value.trim();
      const mes = document.getElementById("mes").value.trim();
      const ano = document.getElementById("ano").value.trim();
      const sheetIdCS = document.getElementById("sheetIdCS").value.trim();
      const gidCS = document.getElementById("gidCS").value.trim();
      const sheetIdService = document.getElementById("sheetIdService").value.trim();
      const gidService = document.getElementById("gidService").value.trim();
      const dataService = document.getElementById("dataService").value.trim();

      const url = `${GAS_URL}?formIds=${form1},${form2}&mes=${mes}&ano=${ano}&sheetIdCS=${sheetIdCS}&gidCS=${gidCS}&sheetIdService=${sheetIdService}&gidService=${gidService}&dataService=${encodeURIComponent(dataService)}`;

      try {
        const response = await fetch(url);
        const data = await response.json();
        document.getElementById("resultado").textContent = JSON.stringify(data, null, 2);
      } catch (err) {
        console.error("Erro:", err);
        alert("Erro ao atualizar notas");
      }
    }
  </script>
</body>

</html>